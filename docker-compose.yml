version: '3'

services:
  auth:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "8002:8000"  # Сопоставляем порт 8000 в контейнере с портом 8002 на хостовой машине
    volumes:
      - .:/app
    environment:
      - ENVIRONMENT=production
      - DB_USER_AUTH=postgres
      - DB_PASS_AUTH=POqtSKRshJavfUCVuLCGsBKVrlRTACmV
      - DB_HOST_AUTH=roundhouse.proxy.rlwy.net
      - DB_PORT_AUTH=57119
      - DB_NAME_AUTH=railway
      - JWT_SECRET_KEY=fuosdp82ipo21epoqwpoe129fdspom12
      - ALGORITHM=HS256
      - ACCESS_TOKEN_EXPIRE_MINUTES=5
      - REFRESH_TOKEN_EXPIRE_DAYS=432000
      - REDIS_URL_AUTH=redis://default:asTehmwvXnscMrJEauqwQyfIcDJXuAko@roundhouse.proxy.rlwy.net:53359
      - SMTP_DOMAIN_NAME=smtp.gmail.com
      - SMTP_PORT=587
      - SMTP_API_KEY=bbtyxgcbnpozfepu
      - SMTP_EMAIL_FROM=y0ur.supp0rt4912385@gmail.com
    depends_on:
      - db
      - redis
  db:
    image: postgres:latest
    environment:
      POSTGRES_DB: auth_db
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: admin_password
    ports:
      - "5432:5432"
  redis:
    image: redis:latest
    ports:
      - "6378:6379"
